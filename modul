Imports MySql.Data.MySqlClient
Module Mudule1
    Public SQLCONNECTION As New MySqlConnection With {.ConnectionString = "SERVER=Localhost;UID=root;PASSWORD=;DATABASE=db_tu"}
    Public SQLCMD As MySqlCommand
    Public SQLDA As MySqlDataAdapter
    Public SQLDR As MySqlDataReader
    Public SQLDS As DataSet
    Public QUERY As String
    Public ID_DATA As String
    Public id_kode As String
    Public KOSONGTEXT As Boolean
    Public kOSONGCOMBO As Boolean
    Public BISALOGIN As Boolean

    Public Sub nampilkeunData(Tabelna As String, Grid As DataGridView)
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand("select * from " & Tabelna, SQLCONNECTION)
            SQLDA = New MySqlDataAdapter(SQLCMD)
            SQLDS = New DataSet
            SQLDA.Fill(SQLDS)
            If SQLDS.Tables.Count > 0 Then
                Grid.DataSource = SQLDS.Tables(0)
            End If

            SQLCONNECTION.Close()
        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
        End Try
    End Sub

    Public Function ExecuteQuery(QueryEx As String) As Boolean
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand(QueryEx, SQLCONNECTION)
            SQLCMD.ExecuteNonQuery()

            SQLCONNECTION.Close()
            Return True
        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
            Return False
        End Try
    End Function

    Public Function NgasupkeunData(Tabelna As String, Isina As String) As Boolean
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand("INSERT INTO " & Tabelna & " VALUES (" & Isina & ")", SQLCONNECTION)
            SQLCMD.ExecuteNonQuery()

            SQLCONNECTION.Close()
            Return True
        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
            Return False
        End Try
    End Function

    Public Function NgeditData(Tabelna As String, Isina As String) As Boolean
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand("UPDATE " & Tabelna & " SET " & Isina & "", SQLCONNECTION)
            SQLCMD.ExecuteNonQuery()

            SQLCONNECTION.Close()
            Return True
        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
            Return False
        End Try
    End Function

    Public Function NgahapusData(Tabelna As String, Fieldna As String, Valuena As String) As Boolean
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand("DELETE FROM " & Tabelna & " WHERE " & Fieldna & " = '" & Valuena & "'", SQLCONNECTION)
            SQLCMD.ExecuteNonQuery()

            SQLCONNECTION.Close()
            Return True
        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
            Return False
        End Try
    End Function

    Public Sub ngasupkeunkaComboBoxASC(Tabelna As String, Fieldna As String, Comboboxna As ComboBox)
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand("Select " & Fieldna & " FROM " & Tabelna & " ORDER BY " & Fieldna & " ASC", SQLCONNECTION)
            SQLDR = SQLCMD.ExecuteReader

            While SQLDR.Read
                Comboboxna.Items.Add(SQLDR(Fieldna))
            End While
            SQLCONNECTION.Close()

        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
        End Try
    End Sub

    Public Sub ngasupkeunkaComboBoxDESC(Tabelna As String, Fieldna As String, Comboboxna As ComboBox)
        Try
            SQLCONNECTION.Open()

            SQLCMD = New MySqlCommand("Select " & Fieldna & " FROM " & Tabelna & " ORDER BY " & Fieldna & " DESC", SQLCONNECTION)
            SQLDR = SQLCMD.ExecuteReader

            While SQLDR.Read
                Comboboxna.Items.Add(SQLDR(Fieldna))
            End While
            SQLCONNECTION.Close()

        Catch ex As Exception
            MsgBox("Gagal : " + ex.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Gagal !")
            If SQLCONNECTION.State = ConnectionState.Open Then
                SQLCONNECTION.Close()
            End If
        End Try
    End Sub

    Sub nyokotIDna(gridna As DataGridView, Kolomkasabaraha As Integer)
        Try
            Dim i As Integer
            i = gridna.CurrentRow.Index
            With gridna.Rows.Item(i)
                ID_DATA = .Cells(Kolomkasabaraha).Value
            End With
        Catch ex As Exception
            MsgBox("Pilih data terlebih dahulu !", MsgBoxStyle.Information + MsgBoxStyle.OkOnly, "Peringatan")
            gridna.Select()
        End Try
    End Sub

    Public Sub NgosongkeunComboBox(Formna As Form)
        For Each Control In Formna.Controls
            If TypeOf Control Is ComboBox Then
                Control.Text = ""
            End If
        Next Control
    End Sub

    Public Sub NgosongkeunTextBox(Formna As Form)
        For Each Control In Formna.Controls
            If TypeOf Control Is TextBox Then
                Control.Text = ""
            End If
        Next Control
    End Sub

    Public Sub NgecekTextBox(Formna As Form, ErrorP As ErrorProvider)
        For Each Control In Formna.Controls
            If TypeOf Control Is TextBox Then
                If Control.Text = "" Then
                    Control.Select
                    ErrorP.SetError(Control, "Harap isi bidang ini !")
                    KOSONGTEXT = True
                Else
                    KOSONGTEXT = False
                End If
            End If
        Next Control
    End Sub

    Public Sub NgecekComboBox(Formna As Form, ErrorP As ErrorProvider)
        For Each Control In Formna.Controls
            If TypeOf Control Is ComboBox Then
                If Control.Text = "" Then
                    Control.Select
                    ErrorP.SetError(Control, "Harap isi bidang ini !")
                    kOSONGCOMBO = True
                Else
                    kOSONGCOMBO = False
                End If
            End If
        Next Control
    End Sub

    Public Sub msgBoxInfo(Pesan As String, Judul As String)
        MsgBox(Pesan, MsgBoxStyle.Information + MsgBoxStyle.OkOnly, Judul)
    End Sub

    Public Sub msgBoxPeringatan(Pesan As String, Judul As String)
        MsgBox(Pesan, MsgBoxStyle.Exclamation + MsgBoxStyle.OkOnly, Judul)
    End Sub

End Module
